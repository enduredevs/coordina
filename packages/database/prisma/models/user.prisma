enum TimeFormat {
  hours12
  hours24

  @@map("time_format")
}

enum UserRole {
  admin
  User

  @@map("user_role")
}

model User {
  id              String      @id @default(cuid())
  name            String
  email           String      @unique @db.Citext
  emailVerified   Boolean?    @map("email_verified")
  image           String?
  timeZone        String?     @map("time_zone")
  weekStart       Int?        @map("week_start")
  timeFormat      TimeFormat? @map("time_format")
  locale          String?
  createdAt       DateTime?   @default(now()) @map("created_at")
  updatedAt       DateTime?   @updatedAt @map("updated_at")
  customerId      String?     @map("customer_id")
  banned          Boolean     @default(false)
  bannedAt        DateTime?   @map("banned_at")
  banReason       String?     @map("ban_reason")
  banExpires      DateTime?   @map("ban_expires")
  role            UserRole    @default(User)
  lastLoginMethod String?     @map("last_login_method")
  isAnonymous     Boolean     @default(false) @map("anonymous")

  sessions             Session[]
  impersonatedSessions Session[] @relation("ImpersonatedSessions")

  @@map("users")
}

model Session {
  id             String   @id
  expiresAt      DateTime @map("expires_at")
  token          String
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")
  ipAddress      String?  @map("ip_address")
  userAgent      String?  @map("user_agent")
  userId         String   @map("user_id")
  impersonatedBy String?  @map("impersonated_by")

  user               User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  impersonatedByUser User? @relation("ImpersonatedSessions", fields: [impersonatedBy], references: [id])

  @@unique([token])
  @@map("sessions")
}

model VerificationToken {
  identifier String   @db.Citext
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_token")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime @map("expires_at")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @default(now()) @map("updated_at")

  @@map("verifications")
}
